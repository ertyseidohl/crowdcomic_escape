!function(t){var e=function(t,i,n,o,s,r){var u=document.getElementById(i);this.renderer=new e.Renderer(this,t,u,n,o,s),this.inputter=new e.Inputter(this,u,r),this.entities=new e.Entities(this,t),this.runner=new e.Runner(this),this.collider=new e.Collider(this);var c=this;new e.Ticker(this,function(e){c.collider.update(e),c.runner.update(e),void 0!==t.update&&t.update(e),c.entities.update(e),c.renderer.update(e)})};t.Coquette=e}(this),function(t){var e=function(t){this.coquette=t};e.prototype={collideRecords:[],update:function(){for(var t=this.coquette.entities.all(),e=0,i=t.length;i>e;e++)for(var n=e;i>n;n++)t[e]!==t[n]&&(this.isIntersecting(t[e],t[n])?this.collision(t[e],t[n]):this.removeOldCollision(t[e],t[n]))},collision:function(t,e){void 0===this.getCollideRecord(t,e)?(this.collideRecords.push([t,e]),i(t,e,this.INITIAL),i(e,t,this.INITIAL)):(i(t,e,this.SUSTAINED),i(e,t,this.SUSTAINED))},removeEntity:function(t){this.removeOldCollision(t)},removeOldCollision:function(t,e){var i=this.getCollideRecord(t,e);if(void 0!==i){var o=this.collideRecords[i];n(o[0],o[1]),n(o[1],o[0]),this.collideRecords.splice(i,1)}},getCollideRecord:function(t,e){for(var i=0,n=this.collideRecords.length;n>i;i++){if(void 0===e&&(this.collideRecords[i][0]===t||this.collideRecords[i][1]===t))return i;if(this.collideRecords[i][0]===t&&this.collideRecords[i][1]===e)return i}},isIntersecting:function(t,e){var i=t.boundingBox||this.RECTANGLE,n=e.boundingBox||this.RECTANGLE;if(i===this.RECTANGLE&&n===this.RECTANGLE)return o.rectanglesIntersecting(t,e);if(i===this.CIRCLE&&n===this.CIRCLE)return o.circlesIntersecting(t,e);if(i===this.CIRCLE)return o.circleAndRectangleIntersecting(t,e);if(i===this.RECTANGLE)return o.circleAndRectangleIntersecting(e,t);throw"Objects being collision tested have unsupported bounding box types."},INITIAL:0,SUSTAINED:1,RECTANGLE:0,CIRCLE:1};var i=function(t,e,i){void 0!==t.collision&&t.collision(e,i)},n=function(t,e){void 0!==t.uncollision&&t.uncollision(e)},o={center:function(t){return void 0!==t.pos?{x:t.pos.x+t.size.x/2,y:t.pos.y+t.size.y/2}:void 0},circlesIntersecting:function(t,e){return o.distance(o.center(t),o.center(e))<t.size.x/2+e.size.x/2},pointInsideObj:function(t,e){return t.x>=e.pos.x&&t.y>=e.pos.y&&t.x<=e.pos.x+e.size.x&&t.y<=e.pos.y+e.size.y},rectanglesIntersecting:function(t,e){return t.pos.x+t.size.x<e.pos.x?!1:t.pos.x>e.pos.x+e.size.x?!1:t.pos.y>e.pos.y+e.size.y?!1:t.pos.y+t.size.y<e.pos.y?!1:!0},distance:function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},rectangleCorners:function(t){var e=[];return e.push({x:t.pos.x,y:t.pos.y}),e.push({x:t.pos.x+t.size.x,y:t.pos.y}),e.push({x:t.pos.x+t.size.x,y:t.pos.y+t.size.y}),e.push({x:t.pos.x,y:t.pos.y+t.size.y}),e},vectorTo:function(t,e){return{x:e.x-t.x,y:e.y-t.y}},magnitude:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},dotProduct:function(t,e){return t.x*e.x+t.y*e.y},unitVector:function(t){return{x:t.x/o.magnitude(t),y:t.y/o.magnitude(t)}},closestPointOnSeg:function(t,e,i){var n=o.vectorTo(t,e),s=o.vectorTo(t,i);if(o.magnitude(n)<=0)throw"Invalid segment length";var r=o.unitVector(n),u=o.dotProduct(s,r);return 0>=u?t:u>=o.magnitude(n)?e:{x:t.x+r.x*u,y:t.y+r.y*u}},isLineIntersectingCircle:function(t,e,i){var n={x:t.pos.x+t.size.x/2,y:t.pos.y+t.size.y/2},s=o.closestPointOnSeg(e,i,n),r=o.vectorTo(s,n);return o.magnitude(r)<t.size.x/2},circleAndRectangleIntersecting:function(t,e){var i=o.rectangleCorners(e);return o.pointInsideObj(o.center(t),e)||o.isLineIntersectingCircle(t,i[0],i[1])||o.isLineIntersectingCircle(t,i[1],i[2])||o.isLineIntersectingCircle(t,i[2],i[3])||o.isLineIntersectingCircle(t,i[3],i[0])}};t.Collider=e,t.Collider.Maths=o}("undefined"==typeof exports?this.Coquette:exports),function(t){var e=function(t,e,i){this.coquette=t,void 0===i&&(i=!0);var n=this,o=window;i?(this.supressedKeys=[this.SPACE,this.LEFT_ARROW,this.UP_ARROW,this.RIGHT_ARROW,this.DOWN_ARROW],window.addEventListener("keydown",function(t){n.supressedKeys.indexOf(t.keyCode)>-1&&t.preventDefault()},!1)):(o=e,o.contentEditable=!0,this.suppressedKeys=[]),o.addEventListener("keydown",this.keydown.bind(this),!1),o.addEventListener("keyup",this.keyup.bind(this),!1)};e.prototype={_state:{},bindings:{},state:function(t,e){return void 0===e?this._state[t]||!1:void(this._state[t]=e)},keydown:function(t){this.state(t.keyCode,!0)},keyup:function(t){this.state(t.keyCode,!1)},BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUM_LOCK:144,SCROLL_LOCK:145,SEMI_COLON:186,EQUALS:187,COMMA:188,DASH:189,PERIOD:190,FORWARD_SLASH:191,GRAVE_ACCENT:192,OPEN_SQUARE_BRACKET:219,BACK_SLASH:220,CLOSE_SQUARE_BRACKET:221,SINGLE_QUOTE:222},t.Inputter=e}("undefined"==typeof exports?this.Coquette:exports),function(t){function e(t){this.coquette=t,this.runs=[]}e.prototype={update:function(){this.run()},run:function(){for(;this.runs.length>0;){var t=this.runs.pop();t.fn(t.obj)}},add:function(t,e){this.runs.push({obj:t,fn:e})}},t.Runner=e}("undefined"==typeof exports?this.Coquette:exports),function(t){function e(t,e){n();var i=(new Date).getTime(),o=function(){var t=(new Date).getTime(),n=t-i;i=t,e(n),requestAnimationFrame(o)};requestAnimationFrame(o)}var i=16,n=function(){for(var t=0,e=["ms","moz","webkit","o"],n=0;n<e.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[n]+"CancelAnimationFrame"]||window[e[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var n=(new Date).getTime(),o=Math.max(0,i-(n-t)),s=window.setTimeout(function(){e(n+o)},o);return t=n+o,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})};t.Ticker=e}("undefined"==typeof exports?this.Coquette:exports),function(t){var e=function(t,e,i,n,o,s){this.coquette=t,this.game=e,i.style.outline="none",i.style.cursor="default",this.ctx=i.getContext("2d"),this.backgroundColor=s,i.width=this.width=n,i.height=this.height=o};e.prototype={getCtx:function(){return this.ctx},update:function(){var t=this.getCtx();t.fillStyle=this.backgroundColor,t.fillRect(0,0,this.width,this.height);for(var e=[this.game].concat(this.coquette.entities.all()),i=0,n=e.length;n>i;i++)void 0!==e[i].draw&&e[i].draw(t)},center:function(){return{x:this.width/2,y:this.height/2}},onScreen:function(t){return t.pos.x>0&&t.pos.x<this.coquette.renderer.width&&t.pos.y>0&&t.pos.y<this.coquette.renderer.height}},t.Renderer=e}("undefined"==typeof exports?this.Coquette:exports),function(t){function e(t,e){this.coquette=t,this.game=e,this._entities=[]}e.prototype={update:function(t){for(var e=this.all(),i=0,n=e.length;n>i;i++)void 0!==e[i].update&&e[i].update(t)},all:function(t){if(void 0===t)return this._entities;for(var e=[],i=0;i<this._entities.length;i++)this._entities[i]instanceof t&&e.push(this._entities[i]);return e},create:function(t,e,n){var o=this;this.coquette.runner.add(this,function(s){var r=new t(o.game,e||{});s._entities.push(r),i(o.all()),void 0!==n&&n(r)})},destroy:function(t,e){this.coquette.runner.add(this,function(i){for(var n=0;n<i._entities.length;n++)if(i._entities[n]===t){i._entities.splice(n,1),void 0!==e&&e();break}})}};var i=function(t){t.sort(function(t,e){var i=t.zindex||0,n=e.zindex||0;return n>i?-1:1})};t.Entities=e}("undefined"==typeof exports?this.Coquette:exports);