!function(e){var t=function(e,i,n,o,s,r){var c=document.getElementById(i);this.renderer=new t.Renderer(this,e,c,n,o,s),this.inputter=new t.Inputter(this,c,r),this.entities=new t.Entities(this,e),this.runner=new t.Runner(this),this.collider=new t.Collider(this);var d=this;this.ticker=new t.Ticker(this,function(t){d.collider.update(t),d.runner.update(t),void 0!==e.update&&e.update(t),d.inputter.lockChanges(),d.entities.update(t),d.renderer.update(t),d.inputter.clearChanges()}),c.addEventListener("mousemove",function(e){var t=c.getBoundingClientRect();d.inputter.mouse.x=e.clientX-t.left+d.renderer.getViewPort().x,d.inputter.mouse.y=e.clientY-t.top+d.renderer.getViewPort().y},!1),c.addEventListener("mousedown",function(){d.inputter.keydown({keyCode:d.inputter.MOUSE_LEFT})},!1),c.addEventListener("mouseup",function(){d.inputter.keyup({keyCode:d.inputter.MOUSE_LEFT})},!1)};e.Coquette=t}(this),function(e){var t=function(e){this.coquette=e};t.prototype={collideRecords:[],update:function(){for(var e=this.coquette.entities.all(void 0,!0),t=0,i=e.length;i>t;t++)for(var n=t;i>n;n++)e[t]!==e[n]&&(this.isIntersecting(e[t],e[n])?this.collision(e[t],e[n]):this.removeOldCollision(e[t],e[n]))},collision:function(e,t){void 0===this.getCollideRecord(e,t)?(this.collideRecords.push([e,t]),i(e,t,this.INITIAL),i(t,e,this.INITIAL)):(i(e,t,this.SUSTAINED),i(t,e,this.SUSTAINED))},removeEntity:function(e){this.removeOldCollision(e)},removeOldCollision:function(e,t){var i=this.getCollideRecord(e,t);if(void 0!==i){var o=this.collideRecords[i];n(o[0],o[1]),n(o[1],o[0]),this.collideRecords.splice(i,1)}},getCollideRecord:function(e,t){for(var i=0,n=this.collideRecords.length;n>i;i++){if(void 0===t&&(this.collideRecords[i][0]===e||this.collideRecords[i][1]===e))return i;if(this.collideRecords[i][0]===e&&this.collideRecords[i][1]===t)return i}},isIntersecting:function(e,t){var i=e.boundingBox||this.RECTANGLE,n=t.boundingBox||this.RECTANGLE;if(i===this.RECTANGLE&&n===this.RECTANGLE)return o.rectanglesIntersecting(e,t);if(i===this.CIRCLE&&n===this.CIRCLE)return o.circlesIntersecting(e,t);if(i===this.CIRCLE)return o.circleAndRectangleIntersecting(e,t);if(i===this.RECTANGLE)return o.circleAndRectangleIntersecting(t,e);throw"Objects being collision tested have unsupported bounding box types."},INITIAL:0,SUSTAINED:1,RECTANGLE:0,CIRCLE:1};var i=function(e,t,i){void 0!==e.collision&&e.collision(t,i)},n=function(e,t){void 0!==e.uncollision&&e.uncollision(t)},o={center:function(e){return void 0!==e.pos?{x:e.pos.x+e.size.x/2,y:e.pos.y+e.size.y/2}:void 0},circlesIntersecting:function(e,t){return o.distance(o.center(e),o.center(t))<e.size.x/2+t.size.x/2},pointInsideObj:function(e,t){return e.x>=t.pos.x&&e.y>=t.pos.y&&e.x<=t.pos.x+t.size.x&&e.y<=t.pos.y+t.size.y},rectanglesIntersecting:function(e,t){return e.pos.x+e.size.x<t.pos.x?!1:e.pos.x>t.pos.x+t.size.x?!1:e.pos.y>t.pos.y+t.size.y?!1:e.pos.y+e.size.y<t.pos.y?!1:!0},distance:function(e,t){var i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)},rectangleCorners:function(e){var t=[];return t.push({x:e.pos.x,y:e.pos.y}),t.push({x:e.pos.x+e.size.x,y:e.pos.y}),t.push({x:e.pos.x+e.size.x,y:e.pos.y+e.size.y}),t.push({x:e.pos.x,y:e.pos.y+e.size.y}),t},vectorTo:function(e,t){return{x:t.x-e.x,y:t.y-e.y}},magnitude:function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},dotProduct:function(e,t){return e.x*t.x+e.y*t.y},unitVector:function(e){return{x:e.x/o.magnitude(e),y:e.y/o.magnitude(e)}},closestPointOnSeg:function(e,t,i){var n=o.vectorTo(e,t),s=o.vectorTo(e,i);if(o.magnitude(n)<=0)throw"Invalid segment length";var r=o.unitVector(n),c=o.dotProduct(s,r);return 0>=c?e:c>=o.magnitude(n)?t:{x:e.x+r.x*c,y:e.y+r.y*c}},isLineIntersectingCircle:function(e,t,i){var n={x:e.pos.x+e.size.x/2,y:e.pos.y+e.size.y/2},s=o.closestPointOnSeg(t,i,n),r=o.vectorTo(s,n);return o.magnitude(r)<e.size.x/2},circleAndRectangleIntersecting:function(e,t){var i=o.rectangleCorners(t);return o.pointInsideObj(o.center(e),t)||o.isLineIntersectingCircle(e,i[0],i[1])||o.isLineIntersectingCircle(e,i[1],i[2])||o.isLineIntersectingCircle(e,i[2],i[3])||o.isLineIntersectingCircle(e,i[3],i[0])}};e.Collider=t,e.Collider.Maths=o}("undefined"==typeof exports?this.Coquette:exports),function(e){var t=function(e,t,i){this.coquette=e,void 0===i&&(i=!0);var n=this,o=window;i?(this.supressedKeys=[this.SPACE,this.LEFT_ARROW,this.UP_ARROW,this.RIGHT_ARROW,this.DOWN_ARROW],window.addEventListener("keydown",function(e){n.supressedKeys.indexOf(e.keyCode)>-1&&e.preventDefault()},!1)):(o=t,o.contentEditable=!0,this.suppressedKeys=[]),o.addEventListener("keydown",this.keydown.bind(this),!1),o.addEventListener("keyup",this.keyup.bind(this),!1),this.mouse={x:0,y:0}};t.prototype={_locked:!1,_lockedChanges:{},_changes:{},_state:{},bindings:{},state:function(e,t){return void 0===t?this._state[e]||!1:void(this._state[e]=t)},lockChanges:function(){this._locked=!0},changes:function(e,t){return void 0===t?this._changes[e]||!1:void(this._locked?this._lockedChanges[e]=t:this._changes[e]=t)},clearChanges:function(){this._changes=this._lockedChanges,this._lockedChanges={},this.locked=!1},keydown:function(e){this.state(e.keyCode,!0),this.changes(e.keyCode,!0)},keyup:function(e){this.state(e.keyCode,!1),this.changes(e.keyCode,!1)},BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUM_LOCK:144,SCROLL_LOCK:145,SEMI_COLON:186,EQUALS:187,COMMA:188,DASH:189,PERIOD:190,FORWARD_SLASH:191,GRAVE_ACCENT:192,OPEN_SQUARE_BRACKET:219,BACK_SLASH:220,CLOSE_SQUARE_BRACKET:221,SINGLE_QUOTE:222,MOUSE_LEFT:1},e.Inputter=t}("undefined"==typeof exports?this.Coquette:exports),function(e){function t(e){this.coquette=e,this.runs=[]}t.prototype={update:function(){this.run()},run:function(){for(;this.runs.length>0;){var e=this.runs.pop();e.fn(e.obj)}},add:function(e,t){this.runs.push({obj:e,fn:t})}},e.Runner=t}("undefined"==typeof exports?this.Coquette:exports),function(e){function t(e,t){n();var i=(new Date).getTime();this.stop=!1;var o=this;this.tick=function(){var e=(new Date).getTime(),n=e-i;i=e,o.stop?t(n):(t(n),requestAnimationFrame(o.tick))},requestAnimationFrame(this.tick)}var i=16,n=function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var n=(new Date).getTime(),o=Math.max(0,i-(n-e)),s=window.setTimeout(function(){t(n+o)},o);return e=n+o,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})};e.Ticker=t}("undefined"==typeof exports?this.Coquette:exports),function(e){var t=function(e,t,i,n,o,s){this.coquette=e,this.game=t,i.style.outline="none",i.style.cursor="default",this.ctx=i.getContext("2d"),this.backgroundColor=s,i.width=n,i.height=o,this.viewSize={x:n,y:o},this.worldSize={x:n,y:o},this.viewCenter={x:n/2,y:o/2},this.lightCanvas=document.createElement("canvas"),this.lightCanvas.width=this.worldSize.x,this.lightCanvas.height=this.worldSize.y};t.prototype={getCtx:function(){return this.ctx},moveViewCenter:function(e){this.viewCenter.x+=e.x,this.viewCenter.y+=e.y},setViewCenter:function(e){this.viewCenter={x:e.x,y:e.y}},setWorldSize:function(e){this.worldSize={x:e.x,y:e.y},this.lightCanvas.width=this.worldSize.x,this.lightCanvas.height=this.worldSize.y},getViewPort:function(){return{x:this.viewCenter.x-this.viewSize.x/2,y:this.viewCenter.y-this.viewSize.y/2,width:this.viewSize.x,height:this.viewSize.y}},update:function(){var e=this.getCtx();e.fillStyle=this.backgroundColor,e.fillRect(-this.viewSize.x/2,-this.viewSize.y/2,this.worldSize.x+this.viewSize.x/2,this.worldSize.y+this.viewSize.y/2);var t=i(this.viewCenter,this.viewSize);e.translate(-t.x,-t.y);var n=this.lightCanvas.getContext("2d");n.clearRect(0,0,n.canvas.width,n.canvas.height);for(var o=this.coquette.entities.all(Light),s=0;s<o.length;s++)o[s].draw(n);n.globalCompositeOperation="source-atop";for(var r=this.coquette.entities.all(Osacian),c=0;c<r.length;c++)r[c].draw(n);for(var d=this.coquette.entities.all(Bullet),l=0;l<d.length;l++)d[l].draw(n);n.globalCompositeOperation="source-over";for(var h=this.coquette.entities.all(GamePlayer),a=0;a<h.length;a++)h[a].draw(n);var u=this.coquette.entities.all(void 0,!0),v=this.coquette.entities.all(void 0,!1);v.push(this.game);for(var f=0,y=0;f<u.length||y<v.length;)f<u.length&&y<v.length&&(u[f].zindex||0)<(v[y].zindex||0)?(void 0!==u[f].draw&&void 0===u[f].isStatic?u[f].draw(e):void 0!==u[f].draw&&(e.translate(t.x,t.y),u[f].draw(e),e.translate(-t.x,-t.y)),f++):y<v.length?(void 0!==v[y].draw&&void 0===v[y].isStatic?v[y].draw(e):void 0!==v[y].draw&&(e.translate(t.x,t.y),v[y].draw(e),e.translate(-t.x,-t.y)),y++):(void 0!==u[f].draw&&void 0===u[f].isStatic?u[f].draw(e):void 0!==u[f].draw&&(e.translate(t.x,t.y),u[f].draw(e),e.translate(-t.x,-t.y)),f++);e.drawImage(this.lightCanvas,0,0),e.translate(t.x,t.y)},center:function(){return{x:this.worldSize.x/2,y:this.worldSize.y/2}},onScreen:function(e){return e.pos.x>=this.viewCenter.x-this.viewSize.x/2&&e.pos.x<=this.viewCenter.x+this.viewSize.x/2&&e.pos.y>=this.viewCenter.y-this.viewSize.y/2&&e.pos.y<=this.viewCenter.y+this.viewSize.y/2}};var i=function(e,t){return{x:Math.floor(e.x-t.x/2),y:Math.floor(e.y-t.y/2)}};e.Renderer=t}("undefined"==typeof exports?this.Coquette:exports),function(e){function t(e,t){this.coquette=e,this.game=t,this._noncolliders=[],this._colliders=[]}t.prototype={update:function(e){for(var t=this.all(),i=0,n=t.length;n>i;i++)void 0!==t[i].update&&t[i].update(e)},all:function(e,t){if(void 0===e)return void 0===t?this._colliders.concat(this._noncolliders):t?this._colliders.slice(0):this._noncolliders.slice(0);var i=void 0===t?0:t?0:this._colliders.length,n=void 0===t?0:t?this._noncolliders.length:0,o=[];for(i;i<this._colliders.length;i++)this._colliders[i]instanceof e&&o.push(this._colliders[i]);for(n;n<this._noncolliders.length;n++)this._noncolliders[n]instanceof e&&o.push(this._noncolliders[n]);return o},create:function(e,t,n){var o=this;this.coquette.runner.add(this,function(s){var r=new e(o.game,t||{});"undefined"==typeof r.noCollision||r.noCollision===!1?(s._colliders.push(r),i(s._colliders)):(s._noncolliders.push(r),i(s._noncolliders)),void 0!==n&&n(r)})},clear:function(e){var t=this,i=this.all();for(var n in i)t.destroy(i[n]);void 0!==e&&e(entity)},destroy:function(e,t){this.coquette.runner.add(this,function(i){for(var n=0;n<i._colliders.length;n++)if(i._colliders[n]===e){i._colliders.splice(n,1),void 0!==t&&t();break}for(var n=0;n<i._noncolliders.length;n++)if(i._noncolliders[n]===e){i._noncolliders.splice(n,1),void 0!==t&&t();break}})}};var i=function(e){e.sort(function(e,t){var i=e.zindex||0,n=t.zindex||0;return n>i?-1:1})};e.Entities=t}("undefined"==typeof exports?this.Coquette:exports);