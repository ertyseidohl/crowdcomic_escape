!function(i){var s=function(i,s){for(var o in s.sensor)this[o]=s.sensor[o];this.door=s.door,this.locked=s.locked,this.orientation=s.orientation||"vertical",this.triggered=!1,this.opening=0,this.openTime=10,this.waiting=0,this.waitTime=30,this.open=!1,this.collision=function(i){(i instanceof GamePlayer||i instanceof Osacian)&&(this.locked||this.triggered||(this.triggered=!0,this.opening=this.openTime,this.waiting=0))},this.uncollision=function(i){(i instanceof GamePlayer||i instanceof Osacian)&&(this.locked||(this.triggered=!1,this.opening=-this.openTime,this.waiting=this.waitTime))},this.update=function(){this.opening>0?this.opening--:this.waiting>0?this.waiting--:this.opening<0&&this.opening++,this.open=0!==this.opening||this.triggered||0!==this.waiting?this.opening>0?!1:this.opening<0&&0===this.waiting?!1:!0:!1},this.draw=function(s){i.GALAXY.debugMode&&(s.strokeStyle="#ff0000",s.strokeRect(this.pos.x,this.pos.y,this.size.x,this.size.y)),s.strokeStyle=i.settings.color_orion;var o=this.getDoorRectangles();o&&o.forEach(function(i){s.strokeRect(i.pos.x,i.pos.y,i.size.x,i.size.y)})},this.getDoorRectangles=function(){if("vertical"==this.orientation){if(0===this.opening&&!this.triggered&&0===this.waiting)return[{pos:{x:this.door.pos.x,y:this.door.pos.y},size:{x:this.door.size.x,y:this.door.size.y/2}},{pos:{x:this.door.pos.x,y:this.door.pos.y+this.door.size.y},size:{x:this.door.size.x,y:-this.door.size.y/2}}];if(this.opening>0)return[{pos:{x:this.door.pos.x,y:this.door.pos.y},size:{x:this.door.size.x,y:this.door.size.y/2*(this.opening/this.openTime)}},{pos:{x:this.door.pos.x,y:this.door.pos.y+this.door.size.y},size:{x:this.door.size.x,y:-(this.door.size.y/2)*(this.opening/this.openTime)}}];if(this.opening<0&&0===this.waiting)return[{pos:{x:this.door.pos.x,y:this.door.pos.y},size:{x:this.door.size.x,y:this.door.size.y/2*(1+this.opening/this.openTime)}},{pos:{x:this.door.pos.x,y:this.door.pos.y+this.door.size.y},size:{x:this.door.size.x,y:-(this.door.size.y/2)*(1+this.opening/this.openTime)}}]}else if("horizontal"==this.orientation){if(0===this.opening&&!this.triggered&&0===this.waiting)return[{pos:{x:this.door.pos.x,y:this.door.pos.y},size:{x:this.door.size.x/2,y:this.door.size.y}},{pos:{x:this.door.pos.x+this.door.size.x,y:this.door.pos.y},size:{x:-this.door.size.x/2,y:this.door.size.y}}];if(this.opening>0)return[{pos:{x:this.door.pos.x,y:this.door.pos.y},size:{x:this.door.size.x/2*(this.opening/this.openTime),y:this.door.size.y}},{pos:{x:this.door.pos.x+this.door.size.x,y:this.door.pos.y},size:{x:-(this.door.size.x/2)*(this.opening/this.openTime),y:this.door.size.y}}];if(this.opening<0&&0===this.waiting)return[{pos:{x:this.door.pos.x,y:this.door.pos.y},size:{x:this.door.size.x/2*(1+this.opening/this.openTime),y:this.door.size.y}},{pos:{x:this.door.pos.x+this.door.size.x,y:this.door.pos.y},size:{x:-(this.door.size.x/2)*(1+this.opening/this.openTime),y:this.door.size.y}}]}},this.getLightSegments=function(){var i=this.getDoorRectangles();if(!i)return[];i=i.map(function(i){return[{x1:i.pos.x,y1:i.pos.y,x2:i.pos.x+i.size.x,y2:i.pos.y},{x1:i.pos.x+i.size.x,y1:i.pos.y,x2:i.pos.x+i.size.x,y2:i.pos.y+i.size.y},{x1:i.pos.x+i.size.x,y1:i.pos.y+i.size.y,x2:i.pos.x,y2:i.pos.y+i.size.y},{x1:i.pos.x,y1:i.pos.y+i.size.y,x2:i.pos.x,y2:i.pos.y}]});var s=[];return s=i.concat.apply(s,i)}};i.GameDoor=s}(this);